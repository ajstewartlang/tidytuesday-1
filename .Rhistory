geom_path(data=md_county,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,aes(x=long,y=lat,colour=factor(responsibility))) +
coord_equal() +
theme_map()
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,aes(x=long,y=lat,colour=factor(responsibility))) +
coord_equal() +
theme_map()
p
full_bridges <- read_csv(url)
unique(full_bridges$county)
unique(md_county$subregion)
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,aes(x=long,y=lat,colour=factor(responsibility))) +
coord_equal() +
theme_nothing()
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,aes(x=long,y=lat,colour=factor(responsibility))) +
coord_equal() +
theme_map()
p
?geom_point
names(bridges)
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_map()
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_map()
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_map() +
labs(title='Bridges in Poor Condition by Responsible Agency')
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme(panel.grid = element_blank())
# theme_map() +
labs(title='Bridges in Poor Condition by Responsible Agency')
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank())
# theme_map() +
labs(title='Bridges in Poor Condition by Responsible Agency')
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank()) +
labs(title='Bridges in Poor Condition by Responsible Agency')
p
?labs
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank()) +
labs(title='Bridges in Poor Condition by Responsible Agency',color='test1',size='test2')
p
View(bridges)
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank()) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
p
p <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
p
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=bridges,
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
bmore_map
#read in data
url <- 'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018-11-27/baltimore_bridges.csv'
full_bridges <- read_csv(url)
bridge_counties <- c('anne arundel','baltimore city','baltimore','carroll',
'harford','howard')
#get county level boundaries, subset for maryland
counties <- map_data("county")
bmore_area <- counties %>%
subset(region %in% bridge_counties)
View(counties)
bmore_area <- counties %>%
subset(subregion %in% bridge_counties)
View(bmore_area)
View(full_bridges)
bmore_map_poor <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition=='Poor'),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
bmore_map_poor
View(bmore_area)
View(bmore_area)
bmore_area <- counties %>%
subset(subregion %in% bridge_counties & region == 'maryland')
View(bmore_area)
unique(bmore_area$subregion)
unique(bmore_area$region)
bmore_map_poor <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition=='Poor'),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
bmore_map_poor
plot_bmore_map <- function(bridge_cond) {
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title='Bridges in Poor Condition by Responsible Agency',
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map('Poor')
plot_bmore_map('Fair')
plot_bmore_map('Good')
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Bridges in ',bridge_cond,' by Responsible Agency')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map('Poor')
min(full_bridges$avg_daily_traffic)
max(full_bridges$avg_daily_traffic)
plot_bmore_map('Good')
View(counties)
View(full_bridges)
bmore_area <- counties %>%
subset(subregion %in% bridge_counties & region == 'maryland') %>%
select(lat,long,bridge_condition,avg_daily_traffic)
unique(full_bridges$responsibility)
table(full_bridges$responsibility)
agency_list <- c('State Highway Agency','County Highway Agency','State Toll Authority',
'City or Municipal Highway Agency')
#clean up responsible agency
table(full_bridges$responsibility)
full_bridges$responsibility_short <- ifelse(full_bridges$responsibility %in% agency_list,
full_bridges$responsibility,
'Other')
View(full_bridges)
bridge_counties <- c('anne arundel','baltimore city','baltimore','carroll',
'harford','howard')
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Bridges in ',bridge_cond,' Condition by Responsible Agency')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Bridges in ',bridge_cond,' Condition by Responsible Agency')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map('Poor')
plot_bmore_map('Fair')
plot_bmore_map('Good')
plot_bmore_map('Poor')
par(mfrow(c(1,3)))
par(mfrow=(c(1,3)))
plot_bmore_map('Poor')
plot_bmore_map('Fair')
plot_bmore_map('Good')
plot_bmore_map('Poor')
getwd()
setwd('~/Desktop/tidytuesday')
map_poor <- plot_bmore_map('Poor')
map_fair <- plot_bmore_map('Fair')
map_good <- plot_bmore_map('Good')
map_poor
?ggsave
ggsave(filename = 'poor_bridge_condition.png', map_poor)
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Bridges in ',bridge_cond,' Condition by Responsible Agency')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
map_poor <- plot_bmore_map('Poor')
map_poor
?ggsave
ggsave(filename = 'poor_bridge_condition.png', map_poor,width = 6,height = 4)
map_fair <- plot_bmore_map('Fair')
ggsave(filename = 'fair_bridge_condition.png', map_fair,width = 6,height = 4)
map_good <- plot_bmore_map('Good')
ggsave(filename = 'good_bridge_condition.png', map_good,width = 6,height = 4)
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Baltimore Area Bridges in ',bridge_cond ' Condition')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Baltimore Area Bridges in ',bridge_cond ' Condition')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Baltimore Area Bridges in ', bridge_cond, ' Condition')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Cars Per Day')
return (bmore_map)
}
plot_bmore_map('Poor')
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Baltimore Area Bridges in ', bridge_cond, ' Condition')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Daily Traffic: (Avg # Vehicles Per Day)')
return (bmore_map)
}
plot_bmore_map('Poor')
#plot each map by bridge condition
map_poor <- plot_bmore_map('Poor')
map_fair <- plot_bmore_map('Fair')
map_good <- plot_bmore_map('Good')
#save
ggsave(filename = 'poor_bridge_condition.png', map_poor,width = 6,height = 4)
ggsave(filename = 'fair_bridge_condition.png', map_fair,width = 6,height = 4)
ggsave(filename = 'good_bridge_condition.png', map_good,width = 6,height = 4)
plot_bmore_map <- function(bridge_cond) {
plot_title <- paste0('Baltimore Area Bridges in ', bridge_cond, ' Condition')
bmore_map <- ggplot() +
geom_polygon(data = bmore_area,aes(fill=NULL,x=long,y=lat,group=group)) +
geom_path(data=bmore_area,aes(x=long,y=lat,group=group),color='white',size=0.1) +
geom_point(data=subset(full_bridges,bridge_condition==bridge_cond),
alpha=0.7,
aes(x=long,y=lat,colour=factor(responsibility_short),size=avg_daily_traffic)) +
coord_equal() +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.text=element_text(size=8)
) +
labs(title=plot_title,
color='Responsible Agency',
size='Vehicles Per Day')
return (bmore_map)
}
#plot each map by bridge condition
map_poor <- plot_bmore_map('Poor')
map_fair <- plot_bmore_map('Fair')
map_good <- plot_bmore_map('Good')
#save
ggsave(filename = 'poor_bridge_condition.png', map_poor,width = 6,height = 4)
ggsave(filename = 'fair_bridge_condition.png', map_fair,width = 6,height = 4)
ggsave(filename = 'good_bridge_condition.png', map_good,width = 6,height = 4)
install.packages('gganimate')
install.packages('devtools')
devtools::install_github('thomasp85/gganimate')
library(devtools)
